CREATE TABLE Empresas (
	Empresa varchar(255),
	NomeEmpresa varchar(255)
);

CREATE TABLE Endereco_Empresas (
	id INT GENERATED BY DEFAULT AS IDENTITY,
	Empresa varchar(255),
	Estado varchar(255),
	CodigoMunicipio varchar(255)
);

CREATE TABLE Fornecedor (
	CodigoFornecedo varchar(255),
	Estado varchar(255),
	CodigoMunicipio varchar(255),
	NomeFornecedor varchar(255)
);
CREATE TABLE Municipio (
	Estado varchar(255),
	CodigoMunicipio varchar(255),
	NomeMunicipio varchar(255)
	);
CREATE TABLE Pedidos (
	Empresa varchar(255),
	CodigoProduto varchar(255),
	QTITEMPED float,
	DTENTITPED DATE
);
CREATE TABLE Produtos (
	CodigoProduto varchar(255),
	CDARVPROD  varchar(255),
	NomeProduto varchar(255)
);

CREATE TABLE Vendas (
	Empresa varchar(255),
	NomeFornecedor varchar(255),
	Valor float,
	DataV date
	);

CREATE TABLE Pedidos_Valorizado (
	Empresa varchar(255),
	Estado varchar(255),
	NomeProduto varchar(255),
	QTITEMPED float,
	VRITEPREBASE float
	);
	
	
//Deletando tabelas 

DROP TABLE Empresas;
DROP TABLE Endereco_Empresas;
DROP TABLE Fornecedor;
DROP TABLE Municipio;
DROP TABLE Pedidos;
DROP TABLE Produtos;
DROP TABLE Vendas;

		
		
	
//importando os dados para o Postgree
COPY Empresas FROM 'C:\tabelas\Empresas_1.csv' CSV HEADER;
COPY Endereco_Empresas FROM 'C:\tabelas\Endereco_Empresas_1.csv' CSV HEADER;
COPY Fornecedor FROM 'C:\tabelas\Fornecedor_1.csv' CSV HEADER;
COPY Municipio FROM 'C:\tabelas\Municipio_1.csv' CSV HEADER;
COPY Pedidos FROM 'C:\tabelas\Pedidos_1.csv' CSV HEADER;
COPY Produtos FROM 'C:\tabelas\Produtos_1.csv' CSV HEADER;
COPY Vendas FROM 'C:\tabelas\Vendas_1.csv' CSV HEADER;

CREATE PROCEDURE AT_TOTAL
AS 
BEGIN
	UPDATE Pedidos_Valorizado
	SET 
END

EXECUTE AT_TOTAL



